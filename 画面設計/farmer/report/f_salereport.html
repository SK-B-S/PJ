<!DOCTYPE html>
<html lang="ja">
    <head>
        <!-- UTF-8でエンコード -->
        <meta charset="UTF-8">
        <!-- デバイスのウィンドウ幅に合わせてページを変更、文字の初期スケールを1に指定 -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- タイトル -->
        <title>売上レポート</title>

        <!-- style_sample.cssを参照 -->
        <!-- defaul static css file -->
        <link rel="stylesheet" href="../../css/static_style/header_style.css">
        <link rel="stylesheet" href="../../css/static_style/body_style.css">
        <link rel="stylesheet" href="../../css/static_style/main_style.css">
        <link rel="stylesheet" href="../../css/static_style/footer_style.css">

        <link rel="stylesheet" href="report_style.css">

        <!-- 最終更新：担当者 更新する度に書き換える -->
        <!-- last update 2025/1/21 杉田 -->
    
    </head>

    <body>

        <header>
            <p>売上レポート</p>
        </header>
        
        <main>
            <div class="container">
                <div class="content">
                    <div class="detail">
                        <p>売上レポート</p>
                    </div>
                </div>

                <table id="dataTable">
                  <thead>
                    <tbody>
                      <!-- 行が追加される領域 -->
                    </tbody>
                    <tr>
                      <th>商品名</th>
                      <th>1月</th>
                      <th>2月</th>
                      <th>3月</th>
                      <th>4月</th>
                      <th>5月</th>
                      <th>6月</th>
                      <th>7月</th>
                      <th>8月</th>
                      <th>9月</th>
                      <th>10月</th>
                      <th>11月</th>
                      <th>12月</th>
                      <th>合計</th>
                    </tr>
                  </thead>
                </table>

                <label class="total-label" id="column13Total">売上総額: 0</label>
              
                <form id="addRowForm">
                  <button type="button">＜</button>
                  <button type="button" onclick="addRow()">商品名を追加</button>
                  <button type="button">＞</button>
                </form>
              
                <script>
                  // 行を追加する関数
                  function addRow() {
                    const tableBody = document.querySelector("#dataTable tbody");
                    const newRow = document.createElement("tr");
              
                    // 1列目（行名）を作成
                    const nameCell = document.createElement("td");
                    nameCell.setAttribute("contenteditable", "true");
                    nameCell.innerHTML = "新しい行";
                    newRow.appendChild(nameCell);
              
                    // 2～13列目を作成して行に追加
                    for (let i = 0; i < 12; i++) {
                      const newCell = document.createElement("td");
                      newCell.setAttribute("contenteditable", "true");
                      newCell.addEventListener("input", () => {
                        updateRowTotal(newRow); // 行の合計を更新
                        updateColumn13Total(); // 列13の合計を更新
                      });
                      newCell.innerHTML = "";
                      newRow.appendChild(newCell);
                    }
              
                    // 14列目（合計）を作成
                    const totalCell = document.createElement("td");
                    totalCell.className = "row-total";
                    totalCell.innerHTML = "0";
                    newRow.appendChild(totalCell);
              
                    tableBody.appendChild(newRow);
                    updateColumn13Total(); // 行が追加された後に列13の合計を更新
                  }
              
                  // 行の合計を計算して14列目に表示する関数
                  function updateRowTotal(row) {
                    const cells = row.querySelectorAll("td:nth-child(n+2):nth-child(-n+13)");
                    let sum = 0;
              
                    cells.forEach(cell => {
                      const value = parseFloat(cell.textContent) || 0;
                      sum += value;
                    });
              
                    row.querySelector(".row-total").textContent = sum;
                  }
              
                  // 列13の合計を計算して表示する関数
                  function updateColumn13Total() {
                    const totalCells = document.querySelectorAll(".row-total");
                    let grandTotal = 0;
              
                    totalCells.forEach(cell => {
                      const value = parseFloat(cell.textContent) || 0;
                      grandTotal += value;
                    });
              
                    document.getElementById("column13Total").textContent = `列13の合計: ${grandTotal}`;
                  }
                </script>

            </div>

        </main>

        <footer>
            <p>ご利用規約・プライバシーポリシー</p>
            <p>© 2024 YUSA S.A.S</p>
        </footer>

    </body>
</html>